<!DOCTYPE html>
<html lang="fr-FR" class="no-js">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width">
	<link rel="profile" href="https://gmpg.org/xfn/11">
	<link rel="pingback" href="https://thomas-veillard.fr/xmlrpc.php">
	<!--[if lt IE 9]>
	<script src="https://thomas-veillard.fr/wp-content/themes/twentyfifteen/js/html5.js?ver=3.7.0"></script>
	<![endif]-->
	<script>(function(html){html.className = html.className.replace(/\bno-js\b/,'js')})(document.documentElement);</script>
<meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">

	<!-- This site is optimized with the Yoast SEO plugin v16.9 - https://yoast.com/wordpress/plugins/seo/ -->
	<title>3. The booking experience | Thomas VEILLARD</title>
	<link rel="canonical" href="https://thomas-veillard.fr/front-end-web-development/practical-works/the-booking-experience/">
	<meta property="og:locale" content="fr_FR">
	<meta property="og:type" content="article">
	<meta property="og:title" content="3. The booking experience | Thomas VEILLARD">
	<meta property="og:description" content="Learning objectives &amp; expected results During this practical activity, you will build the booking experience and take care of business logic. That is the opportunity to: practice reverse engineering ; be more autonomous than during the last practical work ; build more complex forms than previous login component ; use @Input() and @Output() data bindings &hellip; Continuer la lecture de 3. The booking experience">
	<meta property="og:url" content="https://thomas-veillard.fr/front-end-web-development/practical-works/the-booking-experience/">
	<meta property="og:site_name" content="Thomas VEILLARD">
	<meta property="article:published_time" content="2021-02-09T09:00:02+00:00">
	<meta property="article:modified_time" content="2021-03-07T13:19:22+00:00">
	<meta property="og:image" content="https://thomas-veillard.fr/wp-content/uploads/2021/02/demo-input-with-geocoding.gif">
	<meta name="twitter:card" content="summary_large_image">
	<meta name="twitter:label1" content="Écrit par">
	<meta name="twitter:data1" content="Thomas Veillard">
	<meta name="twitter:label2" content="Durée de lecture est.">
	<meta name="twitter:data2" content="7 minutes">
	<script type="application/ld+json" class="yoast-schema-graph">{
	    "@context": "https://schema.org",
	    "@graph": [
	        {
	            "@type": "WebSite",
	            "@id": "https://thomas-veillard.fr/#website",
	            "url": "https://thomas-veillard.fr/",
	            "name": "Thomas VEILLARD",
	            "description": "Mes cours et supports pédagogiques pour l&#039;enseignement de l&#039;ingénierie informatique.",
	            "publisher": {
	                "@id": "https://thomas-veillard.fr/#/schema/person/98465ef1c45a4646324ef7c336388ffb"
	            },
	            "inLanguage": "fr-FR"
	        },
	        {
	            "@type": "ImageObject",
	            "@id": "https://thomas-veillard.fr/front-end-web-development/practical-works/the-booking-experience/#primaryimage",
	            "inLanguage": "fr-FR",
	            "url": "https://thomas-veillard.fr/wp-content/uploads/2021/02/demo-input-with-geocoding.gif",
	            "contentUrl": "https://thomas-veillard.fr/wp-content/uploads/2021/02/demo-input-with-geocoding.gif",
	            "width": 1242,
	            "height": 498
	        },
	        {
	            "@type": "WebPage",
	            "@id": "https://thomas-veillard.fr/front-end-web-development/practical-works/the-booking-experience/#webpage",
	            "url": "https://thomas-veillard.fr/front-end-web-development/practical-works/the-booking-experience/",
	            "name": "3. The booking experience | Thomas VEILLARD",
	            "isPartOf": {
	                "@id": "https://thomas-veillard.fr/#website"
	            },
	            "primaryImageOfPage": {
	                "@id": "https://thomas-veillard.fr/front-end-web-development/practical-works/the-booking-experience/#primaryimage"
	            },
	            "datePublished": "2021-02-09T09:00:02+00:00",
	            "dateModified": "2021-03-07T13:19:22+00:00",
	            "breadcrumb": {
	                "@id": "https://thomas-veillard.fr/front-end-web-development/practical-works/the-booking-experience/#breadcrumb"
	            },
	            "inLanguage": "fr-FR",
	            "potentialAction": [
	                {
	                    "@type": "ReadAction",
	                    "target": [
	                        "https://thomas-veillard.fr/front-end-web-development/practical-works/the-booking-experience/"
	                    ]
	                }
	            ]
	        },
	        {
	            "@type": "BreadcrumbList",
	            "@id": "https://thomas-veillard.fr/front-end-web-development/practical-works/the-booking-experience/#breadcrumb",
	            "itemListElement": [
	                {
	                    "@type": "ListItem",
	                    "position": 1,
	                    "name": "Accueil",
	                    "item": "https://thomas-veillard.fr/"
	                },
	                {
	                    "@type": "ListItem",
	                    "position": 2,
	                    "name": "3. The booking experience"
	                }
	            ]
	        },
	        {
	            "@type": "Article",
	            "@id": "https://thomas-veillard.fr/front-end-web-development/practical-works/the-booking-experience/#article",
	            "isPartOf": {
	                "@id": "https://thomas-veillard.fr/front-end-web-development/practical-works/the-booking-experience/#webpage"
	            },
	            "author": {
	                "@id": "https://thomas-veillard.fr/#/schema/person/98465ef1c45a4646324ef7c336388ffb"
	            },
	            "headline": "3. The booking experience",
	            "datePublished": "2021-02-09T09:00:02+00:00",
	            "dateModified": "2021-03-07T13:19:22+00:00",
	            "mainEntityOfPage": {
	                "@id": "https://thomas-veillard.fr/front-end-web-development/practical-works/the-booking-experience/#webpage"
	            },
	            "wordCount": 846,
	            "publisher": {
	                "@id": "https://thomas-veillard.fr/#/schema/person/98465ef1c45a4646324ef7c336388ffb"
	            },
	            "image": {
	                "@id": "https://thomas-veillard.fr/front-end-web-development/practical-works/the-booking-experience/#primaryimage"
	            },
	            "thumbnailUrl": "https://thomas-veillard.fr/wp-content/uploads/2021/02/demo-input-with-geocoding.gif",
	            "articleSection": [
	                "03. Angular tutorials (archived, need improvments)",
	                "Modern web development"
	            ],
	            "inLanguage": "fr-FR"
	        },
	        {
	            "@type": [
	                "Person",
	                "Organization"
	            ],
	            "@id": "https://thomas-veillard.fr/#/schema/person/98465ef1c45a4646324ef7c336388ffb",
	            "name": "Thomas Veillard",
	            "image": {
	                "@type": "ImageObject",
	                "@id": "https://thomas-veillard.fr/#personlogo",
	                "inLanguage": "fr-FR",
	                "url": "http://2.gravatar.com/avatar/2008ad33ccb3924190bb884024ca6114?s=96&d=mm&r=g",
	                "contentUrl": "http://2.gravatar.com/avatar/2008ad33ccb3924190bb884024ca6114?s=96&d=mm&r=g",
	                "caption": "Thomas Veillard"
	            },
	            "logo": {
	                "@id": "https://thomas-veillard.fr/#personlogo"
	            },
	            "sameAs": [
	                "https://thomas-veillard.fr:8080"
	            ]
	        }
	    ]
	}</script>
	<!-- / Yoast SEO plugin. -->


<link rel="dns-prefetch" href="//fonts.googleapis.com">
<link href="https://fonts.gstatic.com/" crossorigin rel="preconnect">
<link rel="alternate" type="application/rss+xml" title="Thomas VEILLARD &raquo; Flux" href="https://thomas-veillard.fr/feed/">
<link rel="alternate" type="application/rss+xml" title="Thomas VEILLARD &raquo; Flux des commentaires" href="https://thomas-veillard.fr/comments/feed/">
<link rel="stylesheet" id="wp-block-library-css" href="https://thomas-veillard.fr/wp-includes/css/dist/block-library/style.min.css?ver=5.7.2" media="all">
<link rel="stylesheet" id="wp-block-library-theme-css" href="https://thomas-veillard.fr/wp-includes/css/dist/block-library/theme.min.css?ver=5.7.2" media="all">
<link rel="stylesheet" id="vlp-public-css" href="https://thomas-veillard.fr/wp-content/plugins/visual-link-preview/dist/public.css?ver=2.2.1" media="all">
<link rel="stylesheet" id="twentyfifteen-fonts-css" href="https://fonts.googleapis.com/css?family=Noto+Sans%3A400italic%2C700italic%2C400%2C700%7CNoto+Serif%3A400italic%2C700italic%2C400%2C700%7CInconsolata%3A400%2C700&#038;subset=latin%2Clatin-ext&#038;display=fallback" media="all">
<link rel="stylesheet" id="genericons-css" href="https://thomas-veillard.fr/wp-content/themes/twentyfifteen/genericons/genericons.css?ver=20201208" media="all">
<link rel="stylesheet" id="twentyfifteen-style-css" href="https://thomas-veillard.fr/wp-content/themes/twentyfifteen/style.css?ver=20201208" media="all">
<link rel="stylesheet" id="twentyfifteen-block-style-css" href="https://thomas-veillard.fr/wp-content/themes/twentyfifteen/css/blocks.css?ver=20190102" media="all">
<!--[if lt IE 9]>
<link rel='stylesheet' id='twentyfifteen-ie-css'  href='https://thomas-veillard.fr/wp-content/themes/twentyfifteen/css/ie.css?ver=20170916' media='all' />
<![endif]-->
<!--[if lt IE 8]>
<link rel='stylesheet' id='twentyfifteen-ie7-css'  href='https://thomas-veillard.fr/wp-content/themes/twentyfifteen/css/ie7.css?ver=20141210' media='all' />
<![endif]-->
<script src="https://thomas-veillard.fr/wp-includes/js/jquery/jquery.min.js?ver=3.5.1" id="jquery-core-js"></script>
<script src="https://thomas-veillard.fr/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.3.2" id="jquery-migrate-js"></script>
<link rel="https://api.w.org/" href="https://thomas-veillard.fr/wp-json/">
<link rel="alternate" type="application/json" href="https://thomas-veillard.fr/wp-json/wp/v2/posts/2008">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://thomas-veillard.fr/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://thomas-veillard.fr/wp-includes/wlwmanifest.xml"> 
<meta name="generator" content="WordPress 5.7.2">
<link rel="shortlink" href="https://thomas-veillard.fr/?p=2008">
<link rel="alternate" type="application/json+oembed" href="https://thomas-veillard.fr/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhttps://thomas-veillard.fr%2Ffront-end-web-development%2Fpractical-works%2Fthe-booking-experience%2F">
<link rel="alternate" type="text/xml+oembed" href="https://thomas-veillard.fr/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhttps://thomas-veillard.fr%2Ffront-end-web-development%2Fpractical-works%2Fthe-booking-experience%2F&#038;format=xml">
		<style id="wp-custom-css">.entry-title {
	font-size: 1.6em !important;
	text-align: left;
}

article {
	text-align: justify;
	font-size: 0.9em;
}

@media screen and (min-width: 59.6875em) {
	.site-header {
		padding: 0 1em;
	}

	.main-navigation {
		margin: 1em;
	}
}

.main-navigation .current-menu-item > a, .main-navigation .current-menu-ancestor > a {
	font-weight: unset;
	color: black;
}

.main-navigation a {
	color: #666;
}

.no-puce, .no-puce ul {
	list-style-type: none;
}

table {
	margin-bottom: 0;
}

figcaption {
	margin-bottom: 1em !important;
}

h4 {
	margin-top: 1em !important;
	font-size: 1.25em !important;
}

h5 {
	font-size: 1em !important;
	text-transform: none !important;
	margin-top: 1em !important;
}

.exercice {
  padding: 1em;
  border-radius: 3px;
  border: 1px solid #795548;
  background: #f7f7f7;

}

.video-container {
	position: relative;
	padding-bottom: 56.25%; /* 16:9 */
	height: 0;
	margin-bottom: 1em;
}
.video-container iframe {
	position: absolute;
	top: 0;
	left: 0;
	width: 100%;
	height: 100%;
}

.card {
  background: #fff;
  border-radius: 2px;
  padding: 2rem 1rem;
}

.card-1 {
  box-shadow: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24);
  transition: all 0.3s cubic-bezier(.25,.8,.25,1);
}

.card-1-hoverable:hover {
  box-shadow: 0 14px 28px rgba(0,0,0,0.25), 0 10px 10px rgba(0,0,0,0.22);
}

.post-thumbnail {
	margin-bottom: 0;
}

.entry-header {
	color: rgba(51, 51, 51, 0.7);
	font-family: "Noto Sans", sans-serif;
	background-color: #f7f7f7;
	padding-top: 2em;
	padding-bottom: 2em;
	margin-bottom: 1em;
}

.entry-title {
	margin: 0;
	font-weight: normal;
}

.hentry {
	padding-top: 0 !important;
}

table {
	table-layout: auto;
}

.menu-fr > a:before,
.menu-en > a:before {
	content: '';
	display: inline-block;
	width: 1.3em;
	height: 1em;
	margin-right: 0.5em;
}

.menu-fr > a:before {
	background-image: url('https://thomas-veillard.fr/wp-content/uploads/2021/04/fr.svg');
}

.menu-en > a:before {
	background-image: url('https://thomas-veillard.fr/wp-content/uploads/2021/04/en.svg');
}</style>
		</head>

<body class="post-template-default single single-post postid-2008 single-format-standard wp-embed-responsive">
<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="#content">Aller au contenu</a>

	<div id="sidebar" class="sidebar">
		<header id="masthead" class="site-header" role="banner">
			<div class="site-branding">
										<p class="site-title"><a href="https://thomas-veillard.fr/" rel="home">Thomas VEILLARD</a></p>
												<p class="site-description">Mes cours et supports pédagogiques pour l&#039;enseignement de l&#039;ingénierie informatique.</p>
										<button class="secondary-toggle">Menu			</button>
</div>
<!-- .site-branding -->
		</header><!-- .site-header -->

			<div id="secondary" class="secondary">

					<nav id="site-navigation" class="main-navigation" role="navigation">
				<div class="menu-theorie-des-systemes-dexploitation-et-pratique-de-gnu-linux-container"><ul id="menu-theorie-des-systemes-dexploitation-et-pratique-de-gnu-linux" class="nav-menu">
<li id="menu-item-135" class="menu-fr menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-135">
<a href="https://thomas-veillard.fr/category/theorie-des-systemes-dexploitation-et-pratique-de-gnu-linux/">Théorie des systèmes d’exploitation et pratique de GNU/Linux</a>
<ul class="sub-menu">
	<li id="menu-item-49" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-49"><a href="https://thomas-veillard.fr/category/theorie-des-systemes-dexploitation-et-pratique-de-gnu-linux/chapitre-1-introduction/">Chapitre 1. Introduction</a></li>
	<li id="menu-item-558" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-558"><a href="https://thomas-veillard.fr/category/theorie-des-systemes-dexploitation-et-pratique-de-gnu-linux/chapitre-2-les-interfaces-utilisateur/">Chapitre 2. Les interfaces utilisateur</a></li>
</ul>
</li>
<li id="menu-item-1097" class="menu-en menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-has-children menu-item-1097">
<a href="https://thomas-veillard.fr/category/front-end-web-development/">Modern web development</a>
<ul class="sub-menu">
	<li id="menu-item-1366" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1366"><a href="https://thomas-veillard.fr/category/front-end-web-development/introduction/">Introduction</a></li>
	<li id="menu-item-2642" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2642"><a href="https://thomas-veillard.fr/category/front-end-web-development/languages/">Languages</a></li>
</ul>
</li>
</ul></div>			</nav><!-- .main-navigation -->
		
		
		
	</div>
<!-- .secondary -->

	</div>
<!-- .sidebar -->

	<div id="content" class="site-content">

	<div id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		
<article id="post-2008" class="post-2008 post type-post status-publish format-standard hentry category-practical-works category-front-end-web-development">
	
	
	<header class="entry-header">
		<h1 class="entry-title">The booking experience</h1>	</header><!-- .entry-header -->

	<div class="entry-content">
		
<h4>Learning objectives &amp; expected results</h4>



<p>During this practical activity, you will build the booking experience and take care of business logic.</p>



<p>That is the opportunity to:</p>



<ul>
<li>practice reverse engineering ;</li>
<li>be more autonomous than during the last practical work ;</li>
<li>build more complex forms than previous login component ;</li>
<li>use <code>@Input()</code> and <code>@Output()</code> data bindings on component boundaries ;</li>
<li>manage the state of the application and persistence across form steps ;</li>
<li>train yourself with async http requests and angular services ;</li>
<li>think about your UI and UX, so it is convenient for customers ;</li>
<li>use directives such as <code>*ngIf</code> and <code>*ngFor</code>, template variables, etc.</li>
</ul>



<p>Your booking experience must satisfy the following requirements:</p>



<ol>
<li>The customer initiates the booking from the home page. It provides the location of the delivery (postal code or city name). This user input is validated against Openstreetmap API and geocoded.</li>
<li>Geocoded postal address (latitude and longitude) is sent to the server. If zone is covered, the customer goes on next step. Else, an explanation is displayed.</li>
<li>The customer provides basic information describing the service (start date and time, duration).</li>
<li>All collected data are sent to the server, which revolves available employees. The user selects one proposal.</li>
<li>At that time, it may be unauthenticated or unregistered. The user logs in or creates a new customer account. Then it confirms the booking.</li>
</ol>



<h4>Reverse engineering</h4>



<p>I publicly host a sample frontend at <a href="https://backend.thomas-veillard.fr/" target="_blank" rel="noreferrer noopener">https://backend.thomas-veillard.fr</a> to help you understanding the booking process and expected result. Your goal is to mimic its behaviour. That said, you will first analyse it (only the booking part). </p>



<p>Please pay attention to changes occurring in the browser URL and to HTTP calls. For example, analysing the home page would give you something like:</p>


<pre class="wp-block-code" aria-describedby="shcb-language-1" data-shcb-language-name="PHP" data-shcb-language-slug="php"><link rel="stylesheet" id="syntax-highlighting-code-block-css" href="https://thomas-veillard.fr/wp-content/plugins/syntax-highlighting-code-block/vendor/scrivo/highlight-php/styles/default.css?ver=1.3.1" media="all"><style>.wp-block-code {
	border: 0;
	padding: 0;
}

.wp-block-code > div {
	overflow: auto;
}

.shcb-language {
	border: 0;
	clip: rect(1px, 1px, 1px, 1px);
	-webkit-clip-path: inset(50%);
	clip-path: inset(50%);
	height: 1px;
	margin: -1px;
	overflow: hidden;
	padding: 0;
	position: absolute;
	width: 1px;
	word-wrap: normal;
	word-break: normal;
}

.hljs {
	box-sizing: border-box;
}

.hljs.shcb-code-table {
	display: table;
	width: 100%;
}

.hljs.shcb-code-table > .shcb-loc {
	color: inherit;
	display: table-row;
	width: 100%;
}

.hljs.shcb-code-table .shcb-loc > span {
	display: table-cell;
}

.wp-block-code code.hljs:not(.shcb-wrap-lines) {
	white-space: pre;
}

.wp-block-code code.hljs.shcb-wrap-lines {
	white-space: pre-wrap;
}

.hljs.shcb-line-numbers {
	border-spacing: 0;
	counter-reset: line;
}

.hljs.shcb-line-numbers > .shcb-loc {
	counter-increment: line;
}

.hljs.shcb-line-numbers .shcb-loc > span {
	padding-left: 0.75em;
}

.hljs.shcb-line-numbers .shcb-loc::before {
	border-right: 1px solid #ddd;
	content: counter(line);
	display: table-cell;
	padding: 0 0.75em;
	text-align: right;
	-webkit-user-select: none;
	-moz-user-select: none;
	-ms-user-select: none;
	user-select: none;
	white-space: nowrap;
	width: 1%;
}</style><div><code class="hljs language-php"><span class="hljs-number">1.</span> Customer types <span class="hljs-string">"Villejuif"</span> in input[placeholder=<span class="hljs-string">"Enter your city"</span>].

<span class="hljs-number">2.</span> Starting XHR GET https:<span class="hljs-comment">//nominatim.openstreetmap.org/search?format=json&amp;featuretype=city&amp;countrycodes=fr&amp;q=Villejuif.</span>
   Response contains coordinates of Villejuif (lat: <span class="hljs-string">"48.7921098"</span>, lon: <span class="hljs-string">"2.3633048"</span>).

<span class="hljs-number">3.</span> Customer selects geocoded Villejuif in the autocomplete field.

<span class="hljs-number">4.</span> Starting XHR POST https:<span class="hljs-comment">//backend.thomas-veillard.fr/api/bookings/coverage</span>
   Query body is { latitude: <span class="hljs-number">48.7921098</span>, longitude: <span class="hljs-number">2.3633048</span> }.
   Response is { covered: <span class="hljs-keyword">true</span> }.

<span class="hljs-number">5.</span> The user clicks the <span class="hljs-string">'Book now'</span> button.

<span class="hljs-number">6.</span> Navigation occurs <span class="hljs-keyword">and</span> customer is redirected.
   Old path was /.
   <span class="hljs-keyword">New</span> path is /bookings/<span class="hljs-keyword">new</span>/step1/<span class="hljs-number">48.7921098</span>/<span class="hljs-number">2.3633048</span>.

<span class="hljs-number">7.</span> Etc...</code></div><small class="shcb-language" id="shcb-language-1"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">PHP</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">php</span><span class="shcb-language__paren">)</span></small></pre>


<p class="exercice"><strong>Exercise 1</strong>: Analyse the <strong>full</strong> booking process on demonstration frontend like explained above, starting from the home page to the booking process completion. You will need the <code>Network</code> tab of browser developer tools to track XHR calls. Optionally, you may also track component state changes using Augury browser extension.</p>



<h4>Let&rsquo;s write code !</h4>



<p class="exercice"><strong>Exercise 2</strong>: Start a new feature branch and call it <code>booking-experience</code>.</p>



<p class="exercice"><strong>Exercise 3</strong>: You know more components will be created&#8230; Take a few minutes to reorganise your project, so it looks like the following tree.</p>


<pre class="wp-block-code" aria-describedby="shcb-language-2" data-shcb-language-name="PHP" data-shcb-language-slug="php"><div><code class="hljs language-php">src
 ↳ app
    ↳ decorators         <span class="hljs-comment"># empty for now. Will contain typescript decorators.</span>
    ↳ guards             <span class="hljs-comment"># contains guards for @angular/router.</span>
    ↳ routes             <span class="hljs-comment"># contains components respecting the same tree structure as URL paths.</span>
       ↳ home
       ↳ login
       ↳ profile
    ↳ services           <span class="hljs-comment"># contains angular services.</span>
    ↳ shared             <span class="hljs-comment"># empty for now. Will contain shared and reusable components.</span></code></div><small class="shcb-language" id="shcb-language-2"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">PHP</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">php</span><span class="shcb-language__paren">)</span></small></pre>

<div class="exercice" style="display: flex; align-items: center; margin-bottom: 3em; background-color: #ffecb8">
  <i class="fad fa-life-ring" style="font-size: 3em; color: #ffb300; margin-right: 16px"></i>
<div>
  Need help? <a href="https://github.com/TruffeCendree/learning-materials/tree/24f0d2ac3d0754605b25769e5ec33d98698163f9/correction" target="_blank">Explore code</a> or <a href="https://github.com/TruffeCendree/learning-materials/commit/24f0d2ac3d0754605b25769e5ec33d98698163f9" target="_blank">list recent changes</a> on  <i class="fab fa-github" style="margin: 0 0.3em"></i>Github.
</div>
</div>



<h4>Home page</h4>



<figure class="wp-block-image size-large"><img loading="lazy" width="1242" height="498" src="https://thomas-veillard.fr/wp-content/uploads/2021/02/demo-input-with-geocoding.gif" alt="" class="wp-image-2038"><figcaption>The customer enters a city, postal code or postal address, which is geocoded using nominatim API.</figcaption></figure>



<p>I give you some pieces of code that you may reuse. First of all, the <code>GeocodeService</code> can query the <code>nominatim</code> API to search places.</p>


<pre class="wp-block-code" aria-describedby="shcb-language-3" data-shcb-language-name="TypeScript" data-shcb-language-slug="typescript"><div><code class="hljs language-typescript"><span class="hljs-comment">// src/app/services/geocode.service.ts</span>
<span class="hljs-keyword">import</span> { HttpClient } <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/common/http'</span>;
<span class="hljs-keyword">import</span> { Injectable } <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/core'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> NominatimResult {
  display_name: <span class="hljs-built_in">string</span>
  importance: <span class="hljs-built_in">number</span>  
  lat: <span class="hljs-built_in">string</span>
  lon: <span class="hljs-built_in">string</span>
}

<span class="hljs-meta">@Injectable</span>({
  providedIn: <span class="hljs-string">'root'</span>
})
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> GeocodeService {
  <span class="hljs-keyword">constructor</span> (<span class="hljs-params"><span class="hljs-keyword">private</span> httpClient: HttpClient</span>) {}

  geocodeCity (postalAddress: <span class="hljs-built_in">string</span>, country = <span class="hljs-string">'fr'</span>): NominatimResult[] {
    <span class="hljs-comment">// no API call if input is too short</span>
    <span class="hljs-keyword">if</span> (postalAddress.length &lt; <span class="hljs-number">3</span>) <span class="hljs-keyword">return</span> [];

    <span class="hljs-comment">// find OpenStreetMap nominatim API documention at https://nominatim.org/release-docs/latest/api/Search/</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.httpClient.get(<span class="hljs-string">`https://nominatim.openstreetmap.org/search?format=json&amp;featuretype=city&amp;countrycodes=<span class="hljs-subst">${country}</span>&amp;q=<span class="hljs-subst">${postalAddress}</span>`</span>).toPromise() <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>;
  }
}
</code></div><small class="shcb-language" id="shcb-language-3"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">TypeScript</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">typescript</span><span class="shcb-language__paren">)</span></small></pre>


<p>Also, you <strong>must</strong> debounce HTTP calls to OpenStreetMap API. In other words, do not call the geocoding API until the customer stopped writing for 1 second. I provide you ready to use typescript decorator, usable on your callback component method.</p>


<pre class="wp-block-code" aria-describedby="shcb-language-4" data-shcb-language-name="TypeScript" data-shcb-language-slug="typescript"><div><code class="hljs language-typescript"><span class="hljs-comment">// src/app/decorators/debounce.decorator.ts</span>
<span class="hljs-comment">/**
 * Creates a debounced function that delays invoking `func` until after `wait`
 * milliseconds have elapsed since the last time the debounced function was invoked.
 * 
 * See https://blog.bitsrc.io/3-ways-to-debounce-http-requests-in-angular-c407eb165ada
 * 
 * Usage:
 * @Debounce(750)
 * static methodToDebound (args: any) {}
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Debounce</span> (<span class="hljs-params">ms: <span class="hljs-built_in">number</span></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">target: <span class="hljs-built_in">any</span>, key: <span class="hljs-built_in">any</span>, descriptor: <span class="hljs-built_in">any</span></span>) </span>{
    <span class="hljs-keyword">const</span> oldFunc = descriptor.value
    <span class="hljs-keyword">const</span> newFunc = debounce(oldFunc, ms)
    descriptor.value = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">return</span> newFunc.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>)
    }
  }
}

<span class="hljs-comment">/**
 * Creates a debounced function that delays invoking `func` until after `wait`
 * milliseconds have elapsed since the last time the debounced function was invoked.
 * See more at https://github.com/you-dont-need/You-Dont-Need-Lodash-Underscore.
 */</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">debounce</span>&lt;<span class="hljs-title">F</span> <span class="hljs-title">extends</span> <span class="hljs-title">Function</span>&gt;(<span class="hljs-params">func: F, wait: <span class="hljs-built_in">number</span>, immediate = <span class="hljs-literal">false</span></span>): <span class="hljs-title">F</span> </span>{
  <span class="hljs-keyword">let</span> timeout: <span class="hljs-built_in">number</span> | <span class="hljs-literal">null</span>;

  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-comment">// @ts-ignore</span>
    <span class="hljs-keyword">let</span> context = <span class="hljs-keyword">this</span>, args = <span class="hljs-built_in">arguments</span>;

    <span class="hljs-keyword">if</span> (timeout) clearTimeout(timeout);
    timeout = <span class="hljs-built_in">window</span>.setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
      timeout = <span class="hljs-literal">null</span>;
      <span class="hljs-keyword">if</span> (!immediate) func.apply(context, args);
    }, wait);

    <span class="hljs-keyword">if</span> (immediate &amp;&amp; !timeout) func.apply(context, args);
  } <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>
}</code></div><small class="shcb-language" id="shcb-language-4"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">TypeScript</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">typescript</span><span class="shcb-language__paren">)</span></small></pre>


<p>Here an example how to use the decorator.</p>


<pre class="wp-block-code" aria-describedby="shcb-language-5" data-shcb-language-name="TypeScript" data-shcb-language-slug="typescript"><div><code class="hljs language-typescript"><span class="hljs-keyword">class</span> PostalAddressInputComponent {
  <span class="hljs-meta">@Debounce</span>(<span class="hljs-number">1000</span>)
  <span class="hljs-keyword">async</span> searchAddress (rawPostalAddress: <span class="hljs-built_in">string</span>) {
    <span class="hljs-comment">// trigerred 1 time per second max.</span>
    <span class="hljs-comment">// delayed until the method has not been call for 1 second.</span>
  }
}</code></div><small class="shcb-language" id="shcb-language-5"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">TypeScript</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">typescript</span><span class="shcb-language__paren">)</span></small></pre>


<p>Note <code>@angular/material</code> provides ready to use <a href="https://material.angular.io/components/autocomplete/overview" target="_blank" rel="noreferrer noopener">autocomplete field</a> you may import.</p>



<p class="exercice"><strong>Exercise 4</strong>: Build such autocomplete input (as a reusable component) and use it on the home page. You <strong>must</strong> debounce API calls. Also take a few minutes, so your home page looks more friendly.</p>


<div class="exercice" style="display: flex; align-items: center; margin-bottom: 3em; background-color: #ffecb8">
  <i class="fad fa-life-ring" style="font-size: 3em; color: #ffb300; margin-right: 16px"></i>
<div>
  Need help? <a href="https://github.com/TruffeCendree/learning-materials/tree/cb4425eb3f2f655548c71609d4ac51c47bc0feec/correction" target="_blank">Explore code</a> or <a href="https://github.com/TruffeCendree/learning-materials/commit/cb4425eb3f2f655548c71609d4ac51c47bc0feec" target="_blank">list recent changes</a> on  <i class="fab fa-github" style="margin: 0 0.3em"></i>Github.
</div>
</div>



<figure class="wp-block-image size-large"><img loading="lazy" width="1231" height="489" src="https://thomas-veillard.fr/wp-content/uploads/2021/03/demo-coverage-check.gif" alt="" class="wp-image-2123"><figcaption>The home page checks if zone is covered before continuing the booking process. </figcaption></figure>



<p class="exercice"><strong>Exercise 5</strong>: Using the <code>POST /api/bookings/coverage</code> endpoint, check if the customer-entered zone is covered. You should handle at least &lsquo;check in progress&rsquo; and &lsquo;uncovered&rsquo; states.</p>


<div class="exercice" style="display: flex; align-items: center; margin-bottom: 3em; background-color: #ffecb8">
  <i class="fad fa-life-ring" style="font-size: 3em; color: #ffb300; margin-right: 16px"></i>
<div>
  Need help? <a href="https://github.com/TruffeCendree/learning-materials/tree/83ceb34c503bdc8b3d63c01435e2f910a10f172f/correction" target="_blank">Explore code</a> or <a href="https://github.com/TruffeCendree/learning-materials/commit/83ceb34c503bdc8b3d63c01435e2f910a10f172f" target="_blank">list recent changes</a> on  <i class="fab fa-github" style="margin: 0 0.3em"></i>Github.
</div>
</div>



<p class="exercice"><strong>Exercise 6</strong>: When user clicks the &lsquo;Book now!&rsquo; button of the home page, it should be redirected to <code>/bookings/new/step1/:latitude/:longitude</code>. The <code>@angular/router</code> should then load <code>BookingNewStep1Component</code>.</p>



<p>Tips: for your further developments, you could directly access the step2 URL with valid parameters, instead of restarting your tests from the home page. This URL already serialises all parameters you need.</p>



<p>Once the software has acquired delivery city and checked the coverage, the customer goes to the first step of booking form. Inside <code>BookingNewStep1Component</code>, the customer answers some questions:</p>



<ul>
<li>What would be the date of the intervention?</li>
<li>For what duration of cleaning?</li>
<li>From which hour ?</li>
</ul>



<figure class="wp-block-image size-large"><img loading="lazy" width="995" height="732" src="https://thomas-veillard.fr/wp-content/uploads/2021/03/Demo-step-1-booking.gif" alt="" class="wp-image-2167"><figcaption>Expected result for BookingNewStep1Component. The customer selects a start date, start time and duration.</figcaption></figure>



<p class="exercice"><strong>Exercise 7</strong>: Implement the <code>BookingNewStep1Component</code> component. Note that I used undocumented <code>mat-calendar</code> for the date picker. On your side, you may simply use <a href="https://material.angular.io/components/datepicker/overview" target="_blank" rel="noreferrer noopener">mat-datepicker</a>.</p>


<div class="exercice" style="display: flex; align-items: center; margin-bottom: 3em; background-color: #ffecb8">
  <i class="fad fa-life-ring" style="font-size: 3em; color: #ffb300; margin-right: 16px"></i>
<div>
  Need help? <a href="https://github.com/TruffeCendree/learning-materials/tree/bbe39c6fbef58874dd81c71fd0664a8d71f571f2/correction" target="_blank">Explore code</a> or <a href="https://github.com/TruffeCendree/learning-materials/commit/bbe39c6fbef58874dd81c71fd0664a8d71f571f2" target="_blank">list recent changes</a> on  <i class="fab fa-github" style="margin: 0 0.3em"></i>Github.
</div>
</div>



<p>Now, you will implement the submit logic and error handler of this step:</p>



<ul>
<li>The button <code>Find employees</code> should only be visible if the form is fully completed. Else, a message is displayed (e.g. Please select a start date).</li>
<li>On submit, check at least one employee is available.<ul>
<li>If not, display an error which stays until the customer touched the form again. The API will always return <code>unavailable</code> for Sunday.</li>
<li>If any, redirect to the second step.</li>
</ul>
</li>
</ul>



<p>The second step path could be something like:</p>


<pre class="wp-block-code" aria-describedby="shcb-language-6" data-shcb-language-name="PHP" data-shcb-language-slug="php"><div><code class="hljs language-php"><span class="hljs-comment"># pattern of the second step route</span>
/bookings/<span class="hljs-keyword">new</span>/step2/:latitude/:longitude/at/:startDate/:startHour/duration/:duration

<span class="hljs-comment"># example of path instance</span>
/bookings/<span class="hljs-keyword">new</span>/step2/<span class="hljs-number">48.7921098</span>/<span class="hljs-number">48.7921098</span>/at/<span class="hljs-number">2021</span><span class="hljs-number">-03</span><span class="hljs-number">-27</span>/<span class="hljs-number">8</span>/duration/<span class="hljs-number">2</span>

<span class="hljs-comment"># tips: new Date('2021-03-27').toISOString().split('T')[0] === '2021-03-27'</span></code></div><small class="shcb-language" id="shcb-language-6"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">PHP</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">php</span><span class="shcb-language__paren">)</span></small></pre>


<figure class="wp-block-image size-large"><img loading="lazy" width="1058" height="734" src="https://thomas-veillard.fr/wp-content/uploads/2021/03/Demo-step-1-booking-submit.gif" alt="" class="wp-image-2202"><figcaption>Expected behaviour for the submit method of step 1. It checks if any employee is available before redirecting to the second step. Else, it prints errors.</figcaption></figure>



<p class="exercice"><strong>Exercise 8</strong>: Implement the submit method of step 1 component.</p>


<div class="exercice" style="display: flex; align-items: center; margin-bottom: 3em; background-color: #ffecb8">
  <i class="fad fa-life-ring" style="font-size: 3em; color: #ffb300; margin-right: 16px"></i>
<div>
  Need help? <a href="https://github.com/TruffeCendree/learning-materials/tree/55bf37d0a3d8219d16268c91f79d73105dab55ed/correction" target="_blank">Explore code</a> or <a href="https://github.com/TruffeCendree/learning-materials/commit/55bf37d0a3d8219d16268c91f79d73105dab55ed" target="_blank">list recent changes</a> on  <i class="fab fa-github" style="margin: 0 0.3em"></i>Github.
</div>
</div>



<p></p>
	</div>
<!-- .entry-content -->

	
	
	<footer class="entry-footer">
		<span class="cat-links"><span class="screen-reader-text">Catégories </span><a href="https://thomas-veillard.fr/category/front-end-web-development/practical-works/" rel="category tag">03. Angular tutorials (archived, need improvments)</a>, <a href="https://thomas-veillard.fr/category/front-end-web-development/" rel="category tag">Modern web development</a></span>			</footer><!-- .entry-footer -->

</article><!-- #post-2008 -->


	<nav class="navigation post-navigation" role="navigation" aria-label="Publications">
		<h2 class="screen-reader-text">Navigation de l’article</h2>
		<div class="nav-links"><div class="nav-previous"><a href="https://thomas-veillard.fr/front-end-web-development/practical-works/managing-authentication-routing/" rel="prev"><span class="meta-nav" aria-hidden="true">Précédent</span> <span class="screen-reader-text">Article précédent&nbsp;:</span> <span class="post-title">2. Managing authentication &#038; routing</span></a></div></div>
	</nav>
		</main><!-- .site-main -->
	</div>
<!-- .content-area -->


	</div>
<!-- .site-content -->

</div>
<!-- .site -->

<script src="https://kit.fontawesome.com/f02a77f3db.js" crossorigin="anonymous"></script>
<script src="https://thomas-veillard.fr/wp-content/plugins/thomas/js/main.js"></script>
<script data-ad-client="ca-pub-9505048372269906" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-NH45PR7ELJ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-NH45PR7ELJ');
</script>
<script src="https://thomas-veillard.fr/wp-content/themes/twentyfifteen/js/skip-link-focus-fix.js?ver=20141028" id="twentyfifteen-skip-link-focus-fix-js"></script>
<script id="twentyfifteen-script-js-extra">
var screenReaderText = {"expand":"<span class=\"screen-reader-text\">ouvrir le sous-menu<\/span>","collapse":"<span class=\"screen-reader-text\">fermer le sous-menu<\/span>"};
</script>
<script src="https://thomas-veillard.fr/wp-content/themes/twentyfifteen/js/functions.js?ver=20171218" id="twentyfifteen-script-js"></script>
<script src="https://thomas-veillard.fr/wp-includes/js/wp-embed.min.js?ver=5.7.2" id="wp-embed-js"></script>

</body>
</html>